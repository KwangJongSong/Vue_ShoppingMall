<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cartMapper">
    <insert id="addGoodsCart">
        INSERT INTO GOODS_CART_TABLE
        (
            GDS_NUM,
            USER_ID,
            CART_STOCK,
            CART_ADD_DATE
        )
        VALUES(
         #{GDS_NUM},
         #{USER_ID},
         #{CART_STOCK},
         NOW()   
        )
    </insert>

    <insert id="orderInfo">
 INSERT INTO GOODS_ORDER_TABLE(
     ORDER_ID,
     USER_ID, 
     ORDER_RECIEVE, 
     USER_ADDR1, 
     USER_ADDR2, 
     USER_ADDR3, 
     ORDER_PHONE, 
     TOTAL_PRICE)
     VALUES(#{ORDER_ID}, #{USER_ID}, #{ORDER_RECIEVE}, #{USER_ADDR1}, #{USER_ADDR2}, #{USER_ADDR3}, #{ORDER_PHONE}, #{TOTAL_PRICE})
</insert>

    <insert id="orderInfo_Details">
        INSERT INTO GOODS_ORDER_DETAIL_TABLE
    (
        ORDER_ID, 
        GDS_NUM, 
        CART_STOCK
    )
      VALUES
      <foreach collection="reqData" item="item">
        (#{item.ORDER_ID}, #{item.GDS_NUM}, #{item.CART_STOCK})
      </foreach>
      
</insert>

    <select id="getCartList">
        SELECT 
        A.CART_NUM,
        A.USER_ID,
        A.GDS_NUM,
        FORMAT(A.CART_STOCK,0) AS CART_STOCK,
        DATE_FORMAT(A.CART_ADD_DATE, "%Y %c/%e %r") AS CART_ADD_DATE,
        FORMAT(B.GDS_STOCK,0) AS GDS_STOCK,
        B.GDS_IMG,
        B.GDS_NAME,
        B.GDS_PRICE
        FROM GOODS_CART_TABLE AS A
        INNER JOIN GOODS_TABLE AS B
        ON A.GDS_NUM = B.GDS_NUM
        WHERE A.USER_ID = #{user_id}

    </select>

    <delete id="deleteCart">
        DELETE FROM GOODS_CART_TABLE
        WHERE USER_ID = #{USER_ID} AND CART_NUM = #{CART_NUM}
    </delete>
</mapper>